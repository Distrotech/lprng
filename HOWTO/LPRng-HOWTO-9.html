<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE> LPRng-HOWTO: LPRng checkpc Utility</TITLE>
 <LINK HREF="LPRng-HOWTO-10.html" REL=next>
 <LINK HREF="LPRng-HOWTO-8.html" REL=previous>
 <LINK HREF="LPRng-HOWTO.html#toc9" REL=contents>
</HEAD>
<BODY>
<A HREF="LPRng-HOWTO-10.html">Next</A>
<A HREF="LPRng-HOWTO-8.html">Previous</A>
<A HREF="LPRng-HOWTO.html#toc9">Contents</A>
<HR>
<H2><A NAME="checkpc"></A> <A NAME="s9">9. LPRng checkpc Utility</A></H2>

<P>The <CODE>checkpc</CODE> (check printcap file) is one of the most
useful utilities in the LPRng package.
<P>It will read all the configuration files, printcap files and tests
whether devices are set up correctly. Optionally, it will also set the
permissions for spool directories and device files. Additionally, it
will truncate the accounting and log files to a maximum size. Another
use for <CODE>checkpc</CODE> is to remove old entries from queue
directories.
<P>For a new installation, you will want to run
<BLOCKQUOTE><CODE>
<PRE>
checkpc -f -V
</PRE>
</CODE></BLOCKQUOTE>

to set the permissions right. The <CODE>-f</CODE> flag instructs the
program to correct file permissions. If you don't run this as
<CODE>root</CODE>, you'll receive a warning about that fact and any
<B>chown(2)</B> calls will (most likely) fail.
<P>The program reports everything it changes. Since it isn't too clever
about some things (visit the man page), you should keep an eye on the
output, and run it again if needed. If it keeps failing, change the
permissions yourself.
<H2><A NAME="ss9.1">9.1 Maintenance</A>
</H2>

<P>Later, you will want to use <CODE>checkpc</CODE> for the daily
maintenance of your system. I have this line in user <CODE>lp</CODE>'s
crontab:
<BLOCKQUOTE><CODE>
<PRE>
32 5 * * * checkpc -t 10K -A3 -r &gt;/dev/null 2&gt;&amp;1
</PRE>
</CODE></BLOCKQUOTE>

This job will:
<OL>
<LI>truncate all log and accounting files to 10KB (<CODE>-t 10K</CODE>).
Actually, it will keep the last 10K from the file, starting on a
complete line.</LI>
<LI>remove all stale files older than three days (<CODE>-A3 -r</CODE>).</LI>
</OL>

I'm redirecting output to <CODE>/dev/null</CODE>, because <CODE>checkpc</CODE>
is a little noisy to my taste. (But too noisy is better than too
silent :)
<H2><A NAME="ss9.2">9.2 Printcap Information</A>
</H2>

<P>You can use <CODE>checkpc -V -P</CODE>
to examine printcaps and tell you what
they contain.
This is identical to the <CODE>lpc server all</CODE> operation,
but with a higher level of verbosity.
<HR>
<A HREF="LPRng-HOWTO-10.html">Next</A>
<A HREF="LPRng-HOWTO-8.html">Previous</A>
<A HREF="LPRng-HOWTO.html#toc9">Contents</A>
</BODY>
</HTML>
