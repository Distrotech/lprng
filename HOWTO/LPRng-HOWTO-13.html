<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE> LPRng-HOWTO: Filters</TITLE>
 <LINK HREF="LPRng-HOWTO-14.html" REL=next>
 <LINK HREF="LPRng-HOWTO-12.html" REL=previous>
 <LINK HREF="LPRng-HOWTO.html#toc13" REL=contents>
</HEAD>
<BODY>
<A HREF="LPRng-HOWTO-14.html">Next</A>
<A HREF="LPRng-HOWTO-12.html">Previous</A>
<A HREF="LPRng-HOWTO.html#toc13">Contents</A>
<HR>
<H2><A NAME="secfilter"></A> <A NAME="s13">13. Filters</A></H2>

<P>This section gives an overview of how LPRng uses filter programs,
and gives a detailed discussion of how the printcap options and
filters interact.
<H2><A NAME="ss13.1">13.1 What are filters?</A>
</H2>

<P>Print filters are one of the most powerful tools in BSD-style printer
systems.
<P>In general UNIX terms, a <EM>filter</EM> is a program that takes its input
file(s), does something with it, and sends the result to its standard
output. Most UNIX utilities are designed as filters.
(But since you are a system manager, you should already know that :))
<P>In the context of a BSD-style print spooler (and also LPRng), the term
<EM>filter</EM> refers to a program that processes file while it is
being transferred to a printer.
<P>The filter is executed with STDIN reading from the file to be
printed
STDOUT to the printer device or a temporary file.
STDERR (file handle 2) is redirected to the status file,
and file handle&nbsp;3 to an accounting file or program.
<P>A filter can be as simple as a <CODE>LF</CODE> to <CODE>CR/LF</CODE>
translator,
or it can incorporate a complete
accounting system, automatic file type translations,
or even redirect the job to another printing system.
<P>As part of the LPRng project,
the following filters are supported.
The are many others available for use,
but are currently not supported.
<UL>
<LI> 
<A HREF="#lpf">lpf</A>
a very simple CR/LF or passthrough filter.</LI>
<LI> 
<A HREF="#ifhp">ifhp</A>
HP PCL and PJL printer filters </LI>
<LI></LI>
</UL>

The supported filters and other facilities are available from
<A HREF="ftp://ftp.astart.com/pub/LPRng">ftp://ftp.astart.com/pub/LPRng</A><H2><A NAME="if"></A> <A NAME="ss13.2">13.2 What are print formats?</A>
</H2>

<P>Options used:
<UL>
<LI><CODE>if</CODE>,
<CODE>cf</CODE>,
<CODE>df</CODE>,
<CODE>gf</CODE>,
<CODE>nf</CODE>,
<CODE>of</CODE>,
<CODE>rf</CODE>,
<CODE>tf</CODE>,
<CODE>vf</CODE>,
<EM>X</EM><CODE>f</CODE>,
<EM>&nbsp;&nbsp;Filter programs </EM></LI>
</UL>
<P>LPRng has inherited a set of so-called `<B>print formats</B>' from its
BSD ancestor.
The format was used to specify the type of file that was being printed.
The <CODE>lpd</CODE> server
used the print format to select the filter for processing the file.
The de<B>f</B>ault format is <CODE>f</CODE>.
<P>The user can specify the format (i.e., the file type) by giving
the appropriate option to <CODE>lpr</CODE>:
<P>
<UL>
<LI><CODE>-b</CODE> or <CODE>-l</CODE>: Binary (literal) file. No processing should
be done.
The
<CODE>l</CODE> format is recorded as the file format.</LI>
<LI><CODE>-c</CODE>: cifplot(1) output.</LI>
<LI><CODE>-d</CODE>: TeX DVI file.</LI>
<LI><CODE>-g</CODE>: Output from the plot(3X) routines.</LI>
<LI><CODE>-n</CODE> or <CODE>-t</CODE>: (di)troff output.</LI>
<LI><CODE>-p</CODE>: Text file that should be pre-processed by the <CODE>pr</CODE>
command, and then by the standard text filter.</LI>
<LI><CODE>-v</CODE>: Benson Varian raster image.</LI>
</UL>
<P>Alternatively, one can also use
<CODE>-Fx</CODE>, where <CODE>x</CODE> is the format specifier.
(E.g., <CODE>-Fc</CODE>
instead of <CODE>-c</CODE>.)
This last form also allows you to use other
(non-standard) format specifiers.
<P>The filter for format
<CODE>X</CODE>
is the value for the
<CODE>Xf</CODE> printcap
option,
with some minor exceptions.
The following
<CODE>Xf</CODE>
options have a pre-defined meaning.
<P>
<UL>
<LI><CODE>if</CODE>
The <CODE>f</CODE>
format filter,
i.e. - for the default
<CODE>f</CODE>
format.
All print jobs are passed
through this one, unless another format is selected.</LI>
<LI>
<A NAME="cf"></A> 
<CODE>cf</CODE> Cifplot data filter (for <CODE>-c</CODE> format).</LI>
<LI>
<A NAME="df"></A> 
<CODE>df</CODE> Filter for DVI files (<CODE>-d</CODE>).</LI>
<LI>
<A NAME="gf"></A> 
<CODE>gf</CODE> Graph data filter (<CODE>-g</CODE>).</LI>
<LI>
<A NAME="nf"></A> 
<CODE>nf</CODE> Ditroff data filter (<CODE>-n</CODE>).</LI>
<LI><CODE>of</CODE> This filter is used for processing the (optional)
banner at the start and/or end of the print job,
and also for the interjob separators.
See
<A HREF="#ofdetails">of</A> filter for details.</LI>
<LI>
<A NAME="rf"></A> 
<CODE>rf</CODE> Filter for Fortran style files (<CODE>-r</CODE>).</LI>
<LI>
<A NAME="tf"></A> 
<CODE>tf</CODE> Troff filter (<CODE>-t</CODE>).</LI>
<LI>
<A NAME="vf"></A> 
<CODE>vf</CODE> (Versatek) raster image filter (<CODE>-v</CODE>).</LI>
</UL>

<A NAME="ofdetails"></A> <H2><A NAME="ss13.3">13.3 OF Filter</A>
</H2>

<P>The
<CODE>of</CODE>
filter is used to process banners and job separators.
The
<CODE>of</CODE> filter is responsible for performing appropriate
processing of this information and sending to the printer
for action.
<P>While the various file filters are invoked on a once per print file basis,
the
<CODE>of</CODE>
filter is invoked on a once per print job basis.
<P>This filter is the first one to be started,
and should perform whatever specialized device initialization
is needed.
It should also do whatever accounting procedure is desired
for start of job accounting.
<P>The
<CODE>of</CODE>
filter will be given any banner printing or job separation
information for a job.
As part of its operation,
it can detect a specific string,
corresponding to a banner print request,
and generate a banner.
(See the
<A HREF="LPRng-HOWTO-12.html#jobsteps">Job Processing Steps and Printcap Options</A>
for details.)
<P>During operation,
the
<CODE>lpd</CODE> server will send the special
<B>stop</B> sequence of <CODE>\031\001</CODE> to the
<CODE>of</CODE> filter.
The filter must then suspend itself using a
<CODE>kill -STOP</CODE> operation.
The <CODE>lpd</CODE> server will detect that the
<CODE>of</CODE> filter has suspended itself and then
will perform other printing operations.
<P>After the other printing operations have been completed,
the <CODE>of</CODE> will then be sent a
<CODE>kill -CONT</CODE> signal.
<P>This sequence will continue until all information has been printed,
and then the <CODE>of</CODE> filter's STDIN will be closed.
The filter will then perform whatever cleanup operations are needed,
update accounting or other information,
and exit.
<H2><A NAME="pr"></A> <A NAME="ss13.4">13.4 LPR -p format</A>
</H2>

<P>Options used:
<UL>
<LI><CODE>pr=</CODE><EM>pr program for p format</EM></LI>
</UL>
<P>The <CODE>-p</CODE> format is requires filtering the
the input files by the <CODE>pr</CODE> utility
and then passing the result through the
<CODE>if</CODE> filter.
<P>This is widely regarded as a kludge and may not be supported
on your print spooler.
<H2><A NAME="ss13.5">13.5 LPR binary (-l) format</A>
</H2>

<P>The binary (or literal) format is <CODE>-l</CODE>.
The <CODE>if</CODE> filter
is used to process the file,
and is invoked with the
<CODE>-c</CODE>
(<CODE>c</CODE>ancel processing?) flag.
<P>The filter will not modify the file when sending it to the printer,
but may apply various setups to the printer.
<H2><A NAME="filtercmd"></A> <A NAME="py"></A> <A NAME="px"></A> <A NAME="pw"></A> <A NAME="pl"></A> <A NAME="passenv"></A> <A NAME="filterpath"></A> <A NAME="filterldpath"></A> <A NAME="offilteroptions"></A> <A NAME="filteroptions"></A> <A NAME="bkf"></A> <A NAME="bkoffilteroptions"></A> <A NAME="bkfilteroptions"></A> <A NAME="ss13.6">13.6 Filter Command Line Flags</A>
</H2>

<P>Options used:
<UL>
<LI> <CODE>bk_filter_options=</CODE><EM>Backwards Compatible Filter options</EM></LI>
<LI> <CODE>bk_of_filter_options=</CODE><EM>Backwards Compatible OF Filter options</EM></LI>
<LI> <CODE>bkf</CODE><EM>&nbsp;&nbsp;Backwards Compatible Filters</EM></LI>
<LI> <CODE>filter_ld_path=</CODE><EM>Filter LD_LIBRARY_PATH environment</EM></LI>
<LI> <CODE>filter_options=</CODE><EM>Filter options</EM></LI>
<LI> <CODE>filter_path=</CODE><EM>Filter PATH environment</EM></LI>
<LI> <CODE>of_filter_options=</CODE><EM>OF Filter options</EM></LI>
<LI> <CODE>pass_env=</CODE><EM>Environment variables to copy to Filter environment</EM></LI>
<LI> <CODE>pl#</CODE><EM>line count for page</EM></LI>
<LI> <CODE>pw#</CODE><EM>column count for page</EM></LI>
<LI> <CODE>px#</CODE><EM>pixel width for page</EM></LI>
<LI> <CODE>py#</CODE><EM>pixel length for page</EM></LI>
</UL>
<P>A filter (or program) specification in the LPRng printcap database
usually has the form:
<BLOCKQUOTE><CODE>
<PRE>
:option=| [flags] /path [argument | "argument" | 'argument' ]*
:option=[flags]   /path [argument | "argument" | 'argument' ]*
</PRE>
</CODE></BLOCKQUOTE>
<P>The first case is used where the option value can be a string or filter,
and the second where a program is always expected.
The following procedure is used to run a filter program.
Arguments in single or double quotes are passed as a single value,
as for a shell.
No escape (backslash) support is provided.
<P>The sequence of operations to run a filter is as follows:
<OL>
<LI>The program must be specified with an absolute path name.</LI>
<LI>By default, the program is run as the user if invoked from a client
program such as <CODE>lpr</CODE>, <CODE>lpc</CODE>, etc.
If invoked from <CODE>lpd</CODE>,  it is run as the
<CODE>server_user</CODE>
user
(default <CODE>daemon</CODE>) configuration entry.</LI>
<LI>The
<EM>flags</EM> control how the program is to be run.
The following flags are supported:
<UL>
<LI><B>ROOT</B>
This opens a horrible security loophole,
as it will run the program as ROOT.
To enable this option,
you must set various compilation flags,
and perform other arcane operations.
This is deliberately done to make administrators
read the warnings and admonitions.
<P>The alternative to ROOT is to have a setuid ROOT executable.
Under NO circumstances should you run a shell script setuid ROOT,
with general execute permissions on it.
</LI>
<LI><B>-$</B>
This very odd looking flag is used to suppress the addition of
additional command line arguments
specified by the value of <CODE>filter_options</CODE>
to the program command line.</LI>
</UL>
</LI>
<LI>If the <B>-$</B> flag is not specified,
the arguments determined by the value of the <CODE>bkf</CODE>
(Berkeley LPD filter compatible flag) flag are added to the
filter command line.
If <CODE>bkf</CODE> is false the
<CODE>filter_options</CODE> are added for OF filters and
<CODE>of_filter_options</CODE>
are added for non-OF filters;
if it is true, then the
<CODE>bk_filter_options</CODE> and <CODE>bk_of_filter_options</CODE> are added for
OF and non-OF filters respectively.
<P>
<CENTER><TABLE BORDER><TR><TD>
<BR>
Option</TD><TD>DefaultValue</TD></TR><TR><TD>
<CODE>filter_options</CODE></TD><TD>$C $F $H $J $L $P $Q $R $Z $a $c $d $e $f $h $i $j $k $l $n $p$r $s $w $x $y $-a</TD></TR><TR><TD>
<CODE>of_filter_options</CODE></TD><TD>(same as <CODE>filter_options</CODE>)</TD></TR><TR><TD>
<CODE>bk_filter_options</CODE></TD><TD>$P $w $l $x $y $F $c $L $i $J $C $0n $0h $-a</TD></TR><TR><TD>
<CODE>bk_of_filter_options</CODE></TD><TD>$w $l $x $y</TD></TR><TR><TD>

</TD></TR></TABLE></CENTER>
<P>
</LI>
<LI>By default,
for programs that are not being invoked as print job file filters,
the
<CODE>filter_options</CODE>
arguments are added.
For print job filters, if the <CODE>bkf</CODE> flag is set,
then the
<CODE>bk_filter_options</CODE>
and
<CODE>bk_of_filter_options</CODE>
entries are used.
The default <CODE>bk</CODE> filter options are the same as originally used
with the BSD LPR filters.
For the <CODE>of</CODE> filter,
either the <CODE>of_filter_options</CODE>
or <CODE>bk_of_filter_options</CODE> arguments will be added.</LI>
<LI>The program arguments will then be scanned and interpreted.
Arguments of the form <CODE>$</CODE><EM>letter</EM> will be
translated into values from the
print job control file and/or printcap entry.
The letters have the following meaning:
<CENTER><TABLE BORDER><TR><TD>
<BR>
Letter</TD><TD>TranslatedValue</TD></TR><TR><TD>
<CODE>a </CODE></TD><TD>printcap <CODE>af</CODE> (accounting file name)</TD></TR><TR><TD>
<CODE>b </CODE></TD><TD>job size (in K bytes)</TD></TR><TR><TD>
<CODE>c </CODE></TD><TD>binary file (<CODE>l</CODE> format for print file)</TD></TR><TR><TD>
<CODE>d </CODE></TD><TD>printcap <CODE>cd</CODE> or <CODE>sd</CODE> entry</TD></TR><TR><TD>
<CODE>e </CODE></TD><TD>print job data file name (currently being processed)</TD></TR><TR><TD>
<CODE>f </CODE></TD><TD>print job original name when spooled for printing (N info from control file)</TD></TR><TR><TD>
<CODE>h </CODE></TD><TD>print job originating host (H info from control file)</TD></TR><TR><TD>
<CODE>i </CODE></TD><TD>indent request (I info from control file)</TD></TR><TR><TD>
<CODE>j </CODE></TD><TD>job number in spool queue</TD></TR><TR><TD>
<CODE>k </CODE></TD><TD>print job control file name</TD></TR><TR><TD>
<CODE>l </CODE></TD><TD>printcap <CODE>pl</CODE> (page length)</TD></TR><TR><TD>
<CODE>m </CODE></TD><TD>printcap <CODE>co</CODE></TD></TR><TR><TD>
<CODE>n </CODE></TD><TD>user name (L info from control file)</TD></TR><TR><TD>
<CODE>p </CODE></TD><TD>remote printer (when processing for bounce queue)</TD></TR><TR><TD>
<CODE>r </CODE></TD><TD>remote host (when processing for bounce queue)</TD></TR><TR><TD>
<CODE>s </CODE></TD><TD>printcap <CODE>sf</CODE> (status file)</TD></TR><TR><TD>
<CODE>t </CODE></TD><TD>time in common UNIX format</TD></TR><TR><TD>
<CODE>w </CODE></TD><TD>printcap <CODE>pw</CODE> (page width)</TD></TR><TR><TD>
<CODE>x </CODE></TD><TD>printcap <CODE>px</CODE> (page x dimension)</TD></TR><TR><TD>
<CODE>y </CODE></TD><TD>printcap <CODE>py</CODE> (page y dimension)</TD></TR><TR><TD>
<CODE>F </CODE></TD><TD>print file format</TD></TR><TR><TD>
<CODE>P </CODE></TD><TD>printer name</TD></TR><TR><TD>
<CODE>S </CODE></TD><TD>printcap <CODE>cm</CODE> (comment field)</TD></TR><TR><TD>
Capital letter</TD><TD>Corresponding line from control file</TD></TR><TR><TD>
{key}</TD><TD>printcap value for <CODE>key</CODE></TD></TR><TR><TD>

</TD></TR></TABLE></CENTER>
</LI>
<LI>If there is no value for the specified argument,
then the argument is removed from the list.
If there is a value, the actual form of the substitution is
controlled by additional flags as follows.
<CENTER><TABLE BORDER><TR><TD>
<BR>
Form</TD><TD>TranslatedValue</TD></TR><TR><TD>
<CODE> $x </CODE></TD><TD><CODE>'-x<EM>value</EM>' </CODE></TD></TR><TR><TD>
<CODE> $-x </CODE></TD><TD><CODE> '<EM>value</EM>' </CODE></TD></TR><TR><TD>
<CODE> $0x </CODE></TD><TD><CODE> -x '<EM>value</EM>' </CODE></TD></TR><TR><TD>
<CODE> $'x </CODE></TD><TD><CODE> -x <EM>value</EM> </CODE></TD></TR><TR><TD>

</TD></TR></TABLE></CENTER>

<P>Each entry in quotes is treated as a single value,
as in /bin/sh.
The <CODE>$'x</CODE> does not quote the value.
Combinations of the various flags are allowed.  For example,
<CODE>$-x</CODE> would simply substitute the value for <CODE>x</CODE>,
and then pass the whitespace separated components as individual arguments.
This last form is useful for adding in additional flags on the command line.
</LI>
<LI>The command line is parsed,
metacharacters are ruthlessly stripped from all arguments and pathnames
and replaced by <CODE>_</CODE> (underscores),
and an argument list suitable for the <CODE>execve</CODE> system call
is formed.</LI>
<LI>A sanitized environment is set up for the program execution,
with the following environment variables.
<P>
<CENTER><TABLE BORDER><TR><TD>
<BR>
<CODE> USER </CODE></TD><TD>User name (client only)</TD></TR><TR><TD>
<CODE> LOGNAME </CODE></TD><TD>L control file info</TD></TR><TR><TD>
<CODE> HOME </CODE></TD><TD>Home directory (client only)</TD></TR><TR><TD>
<CODE> LOGDIR </CODE></TD><TD>Home directory (client only)</TD></TR><TR><TD>
<CODE> PATH </CODE></TD><TD><CODE>filter_path</CODE> configuration information</TD></TR><TR><TD>
<CODE> LD_LIBRARY_PATH </CODE></TD><TD><CODE> filter_ld_path </CODE> configuration information</TD></TR><TR><TD>
<CODE> SHELL </CODE></TD><TD><CODE>/bin/sh</CODE></TD></TR><TR><TD>
<CODE> IFS </CODE></TD><TD><CODE>" \t"</CODE></TD></TR><TR><TD>
<CODE> TZ </CODE></TD><TD>Time zone</TD></TR><TR><TD>
<CODE> SPOOL_DIR </CODE></TD><TD><CODE>sd</CODE> printcap info</TD></TR><TR><TD>
<CODE> CONTROL_DIR </CODE></TD><TD><CODE>cd</CODE> printcap info</TD></TR><TR><TD>
<CODE> PRINTCAP_ENTRY </CODE></TD><TD>printcap info</TD></TR><TR><TD>
<CODE> CONTROL </CODE></TD><TD>control file</TD></TR><TR><TD>

</TD></TR></TABLE></CENTER>
<P>
</LI>
<LI>If the filter is to be run by a client program such as <CODE>lpr</CODE>,
then the environment variables specified by the
<CODE>pass_env</CODE> configuration or printcap option will be
extracted from the environment,
have any metacharacters removed,
and then placed in the environment variable list.
Commonly, the
<CODE>PGPPASS</CODE>,
<CODE>PGPPASSFD</CODE>,
and <CODE>PGPPATH</CODE> are specified.</LI>
<LI>The program is started,
with STDIN, STDOUT, and STDERR attached to the appropriate files or
file descriptors.
If none is specified, then they are attached to
<CODE>/dev/null</CODE>.</LI>
</OL>
<H2><A NAME="ss13.7">13.7 LPRng Supported Filters</A>
</H2>

<P>There already exists a large library of ready-to-use filters. Some of
them have LPRng-specific versions, which can be found at the
<A HREF="LPRng-HOWTO-1.html#secftp">LPRng ftp mirror sites</A>.
<H3>Filter Distribution Conventions</H3>

<P>By convention,
most filters are either totally standalone (very rare),
or require a set of support files.
There are two types of support files: per print queue configuration information
and global support information.
<P>Since a print filter will execute with the current directory set to the
spool queue directory,
most filters expect that per print queue configuration information
should be kept in the spool directory.
Most <EM>vintage</EM> filters insist on having these files <EM>hidden</EM>
with names such as <B><CODE>.setup</CODE></B>.
This can make it difficult for administrators to determine where the
configuration files are.
<P>It is strongly recommended that filters and information
be placed in commonly accessible directories such as
<CODE><B>/usr/local/lib/filters</B></CODE>,
and the executables in subdirectories.
This allows the LPRng administrator to set the privileges on these
directories such that only the <CODE>lpd</CODE> process can
access them.
<P>Most of the LPRng supported filters can either be used as a
<CODE>if</CODE> or <CODE>of</CODE> filter.
The filter will examine the format type passed by the <CODE>-F<EM>X</EM></CODE>
command line argument,
and if it is <CODE>o</CODE> it will perform as an <CODE>of</CODE> filter.
<P>Alternatively,
the filter will check the filename in the pathname by which is was invoked.
If the name has the substring <CODE>of</CODE> in the filename,
then it assumes it is to act as an <CODE>of</CODE> filter.
This allows symbolic links to be made to a common filter executable,
each of which corresponds to the filter name by which it is to be invoked.
<P>When a filter is invoked,
it is passed a large number of options,
many of which are totally ignored in filter operation.
However,
for many purposes it is necessary to provide options to the
filters to tailor their operation to the particular spool queue needs.
<P>By convention,
all LPRng supported filters use the
<BLOCKQUOTE><CODE>
<PRE>
-Tkey=value[,key=value]
</PRE>
</CODE></BLOCKQUOTE>
<P>convention for specifying filter configuration option values.
<H2><A NAME="lpf"></A> <A NAME="ss13.8">13.8 lpf</A>
</H2>

<P>Source code:
<A HREF="LPRng-HOWTO-1.html#secftp">LPRng Distribution</A><P>This filter is distributed as part of the LPRng source code,
and has a very limited functionality.
By default,
it only translates <CODE>\n</CODE> to <CODE>\r\n</CODE>
sequences,
and detects the OF Filter Stop sequence when invoked as an OF filter.
<UL>
<LI>Options:<BR>
<CODE>-Tcrlf</CODE> - suppress <CODE>\n</CODE> to <CODE>\r\n</CODE> translation</LI>
</UL>
<H2><A NAME="ifhp"></A> <A NAME="ss13.9">13.9 IFHP Filter</A>
</H2>

<P>Source code:
<A HREF="LPRng-HOWTO-1.html#secftp">LPRng Distribution, ifhp-&lt;em>version&lt;/em>.tgz</A><P>This filter supports a wide variety of <I>smart</I> printers,
or to be more specific,
printers which support PostScript, PCL or PJL languages.
<H3>Printer Capabilities</H3>

<P>As explained in
<A HREF="LPRng-HOWTO-3.html#installref">Setting Up Your Printer</A>,
you can have a parallel (unidirectional),
serial (bidirectional),
or network (bidirectional) connection.
When using a bidirectional connection,
you can sometime obtain or gratuitously receive error and/or status
information from the printer.
<P>Some printers will spontaneously generate error messages when printing
a job on a bidirectional interface.
Usually, though,
it it necessary to force the printer to provide status in a reasonable format.
<P>Some printers have the capability of printing either PCL or PostScript;
some require special setup commands and some will <EM>autosense</EM> which
type of job is being printed.
<P>If you are printing text,
and not using a Page Description Language like PostScript or PCL,
then you may want to download a font to the printer.
This is especially the case when you are trying to print text files
in a non-English font.
<P>Some printers will provide a <EM>hardware</EM> page counter value when requested;
however,
the means of requesting differ from model to model.
<P>Sometimes you want to generate a special banner for a particular printer,
and need to put in some dynamic information.
While this can be done by the <CODE>lpd</CODE> server using the
<CODE>bp</CODE> program specification,
it turns out that non-LPRng systems which want to use the <CODE>ifhp</CODE>
want to have the same facilities.
Thus,  you need to have some way to get the same effect as the <CODE>bp</CODE>
option,  but at the filter level.
<P>Having done <CODE>lpd</CODE> banner generation and printing,
why not have the filter run an accounting script as well?
<P>At this point,  I suspect that the reader is beginning to suspect that
making a general purpose filter to support all of these possibilities is
difficult.
That is incorrect.  It is <B>extremely</B> difficult.
<P>However,
the <CODE>ifhp</CODE> filter greatly simplifies this,
as it uses a simple database together with some printer configuration options.
For details,
see the <CODE>ifhp</CODE> documentation for details on using the filter.
For the terminally impatient,
the following is a quick cookbook:
<BLOCKQUOTE><CODE>
<PRE>
# network connection to jet direct box,
#   no banners, HP compatible
lp
  :lp=ipaddr%9100
  :/usr/local/lib/filters/ifhp
  :sh:sf
#
# banner added
#
lp
  :bp=/usr/local/lib/filters/pclbanner
  :of=/usr/local/lib/filters/ifhp
  :if=/usr/local/lib/filters/ifhp
  :sf
#
# for a parallel port printer or when you want VERY fast
#  throughput, no pagecounts, error messages, etc.  The
#
lp
  :ifhp=status@
  :/usr/local/lib/filters/ifhp
  :sh:sf
</PRE>
</CODE></BLOCKQUOTE>
<H2><A NAME="ss13.10">13.10 Using your own filters</A>
</H2>

<P>If you already have a working setup, with its own specific filter
programs, you might want to keep them. Or, you might want to write a
set of your own.
<P>See the source code in the
<A HREF="LPRng-HOWTO-1.html#secftp">LPRng Distribution, FILTERS_LPRng-&lt;version>.tgz</A> files for examples.
<HR>
<A HREF="LPRng-HOWTO-14.html">Next</A>
<A HREF="LPRng-HOWTO-12.html">Previous</A>
<A HREF="LPRng-HOWTO.html#toc13">Contents</A>
</BODY>
</HTML>
