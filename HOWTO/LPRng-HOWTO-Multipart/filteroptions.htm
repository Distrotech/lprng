<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta name="generator" content="HTML Tidy, see www.w3.org">
    <title>Filter Command Line Options and Environment
    Variables</title>
    <meta name="GENERATOR" content=
    "Modular DocBook HTML Stylesheet Version 1.71 ">
    <link rel="HOME" title=" LPRng-HOWTO" href="index.htm">
    <link rel="UP" title="Filters " href="filters.htm">
    <link rel="PREVIOUS" title="Chaining Filters " href=
    "chainingfilters.htm">
    <link rel="NEXT" title="LPRng Supported Filters" href=
    "x8279.htm">
  </head>

  <body class="SECT1" bgcolor="#FFFFFF" text="#000000" link=
  "#0000FF" vlink="#840084" alink="#0000FF">
    <div class="NAVHEADER">
      <table summary="Header navigation table" width="100%" border=
      "0" cellpadding="0" cellspacing="0">
        <tr>
          <th colspan="3" align="center">LPRng-HOWTO: 1 Apr 2002
          (For LPRng-3.8.10)</th>
        </tr>

        <tr>
          <td width="10%" align="left" valign="bottom"><a href=
          "chainingfilters.htm" accesskey="P">Prev</a></td>

          <td width="80%" align="center" valign="bottom">Chapter
          16. Filters</td>

          <td width="10%" align="right" valign="bottom"><a href=
          "x8279.htm" accesskey="N">Next</a></td>
        </tr>
      </table>
      <hr align="LEFT" width="100%">
    </div>

    <div class="SECT1">
      <h1 class="SECT1"><a name="FILTEROPTIONS">16.8. Filter
      Command Line Options and Environment Variables</a></h1>

      <p>Options used:</p>

      <ul>
        <li>
          <p><tt class="LITERAL">bk_filter_options=</tt><i class=
          "EMPHASIS">Backwards Compatible Filter options</i></p>
        </li>

        <li>
          <p><tt class="LITERAL">bk_of_filter_options=</tt><i
          class="EMPHASIS">Backwards Compatible OF Filter
          options</i></p>
        </li>

        <li>
          <p><tt class="LITERAL">bkf</tt> FLAG <i class=
          "EMPHASIS">Backwards Compatible Filters</i></p>
        </li>

        <li>
          <p><tt class="LITERAL">filter_ld_path=</tt><i class=
          "EMPHASIS">Filter LD_LIBRARY_PATH environment</i></p>
        </li>

        <li>
          <p><tt class="LITERAL">filter_options=</tt><i class=
          "EMPHASIS">Filter options</i></p>
        </li>

        <li>
          <p><tt class="LITERAL">filter_path=</tt><i class=
          "EMPHASIS">Filter PATH environment</i></p>
        </li>

        <li>
          <p><tt class="LITERAL">of_filter_options=</tt><i class=
          "EMPHASIS">OF Filter options</i></p>
        </li>

        <li>
          <p><tt class="LITERAL">pass_env=</tt><i class=
          "EMPHASIS">Environment variables to copy to Filter
          environment</i></p>
        </li>

        <li>
          <p><tt class="LITERAL">pl=</tt><i class="EMPHASIS">line
          count for page</i></p>
        </li>

        <li>
          <p><tt class="LITERAL">pw=</tt><i class="EMPHASIS">column
          count for page</i></p>
        </li>

        <li>
          <p><tt class="LITERAL">px=</tt><i class="EMPHASIS">pixel
          width for page</i></p>
        </li>

        <li>
          <p><tt class="LITERAL">py=</tt><i class="EMPHASIS">pixel
          length for page</i></p>
        </li>
      </ul>
      <br>
      <br>

      <p>A filter (or program) specification in the <b class=
      "APPLICATION">LPRng</b> printcap database has the form:</p>

      <div class="INFORMALEXAMPLE">
        <a name="AEN7937"></a>
<pre class="SCREEN">
    :option=| [flags] /path [argument | "argument" | 'argument' ]*
    :option=[flags]   /path [argument | "argument" | 'argument' ]*
</pre>
      </div>
      <br>
      <br>

      <p>The first case is used where the option value can be a
      string or filter, and the second where a program is always
      expected. The following procedure is used to run a filter
      program. Arguments in single or double quotes are passed as a
      single value, as for a shell.</p>

      <p>The sequence of operations to run a filter is as
      follows:</p>

      <ol type="1">
        <li>
          <p>The program must be specified with an absolute path
          name.</p>
        </li>

        <li>
          <p>By default, the program is run as the user if invoked
          from a client program such as <b class=
          "APPLICATION">lpr</b>, <b class="APPLICATION">lpc</b>,
          etc. If invoked from <b class="APPLICATION">lpd</b>, it
          is run as the user ID specified by the <tt class=
          "LITERAL">:user</tt> (default <tt class=
          "LITERAL">daemon</tt>) configuration entry.</p>
        </li>

        <li>
          <p>The <tt class="LITERAL">filter_path</tt> (default <tt
          class="LITERAL">/bin:/usr/bin:/usr/local/bin</tt>, and
          <tt class="LITERAL">filter_ld_path</tt> (default <tt
          class="LITERAL">/lib:/usr/lib:/usr/local/lib</tt>,
          configuration options specifies the value of the <tt
          class="LITERAL">PATH</tt> and <tt class=
          "LITERAL">LD_LIBRARY_PATH</tt> environment variables.</p>
        </li>

        <li>
          <p>The <tt class="LITERAL">filter_path</tt> (default <tt
          class="LITERAL">/bin:/usr/bin:/usr/local/bin</tt>, and
          <tt class="LITERAL">filter_ld_path</tt> (default <tt
          class="LITERAL">/lib:/usr/lib:/usr/local/lib</tt>,
          configuration option specifies the value of the <tt
          class="LITERAL">PATH</tt> and <tt class=
          "LITERAL">LD_LIBRARY_PATH</tt> environment variables. The
          other enviroment variables are described in <a href=
          "filteroptions.htm#FILTERENV"><b class=
          "APPLICATION">LPRng</b> ftp mirror sites Filter
          Environment Variables</a></p>
        </li>

        <li>
          <p><span class="ACRONYM">ROOT</span> Flag. If the ROOT
          flag is specified the filter is executed with Userid and
          Effective Userid ROOT (User ID 0). By default it is
          executed with the <tt class="LITERAL">user</tt> and <tt
          class="LITERAL">group</tt> configuration option user and
          group ids. Running a filter as ROOT is extremely
          dangerous, and should only be used for programs that
          require root permissions to open files or make network
          connections from privileged ports.</p>
        </li>

        <li>
          <p><tt class="LITERAL">$-</tt> or <tt class=
          "LITERAL">-$</tt> Flag. This flag suppresses appending
          options to the filter command line. If the <i class=
          "EMPHASIS">$-</i> or <tt class="LITERAL">-$</tt> flag is
          not present, the <tt class="LITERAL">:filter_options</tt>
          or <tt class="LITERAL">:of_filter_options</tt> for the
          <tt class="OPTION">:of</tt> filter values are appended to
          the filter command line. If the <tt class=
          "LITERAL">:bkf</tt> (Berkeley <b class=
          "APPLICATION">lpd</b> filter compatible flag) is <tt
          class="LITERAL">TRUE</tt> then the <tt class=
          "LITERAL">:bk_filter_options</tt> and <tt class=
          "LITERAL">:bk_of_filter_options</tt> values are used
          instead of the <tt class="LITERAL">:filter_options</tt>
          and <tt class="LITERAL">:of_filter_options</tt>
          values.</p>

          <div class="TABLE">
            <a name="PRINTFILTERCOMMAND"></a>

            <p><b>Table 16-1. Print Filter Command Line
            Options</b></p>

            <table border="1" class="CALSTABLE">
              <thead>
                <tr>
                  <th align="LEFT" valign="TOP">Option</th>

                  <th align="LEFT" valign="TOP">DefaultValue</th>
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td align="LEFT" valign="TOP">Option</td>

                  <td align="LEFT" valign="TOP">DefaultValue</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">filter_options</tt></td>

                  <td align="LEFT" valign="TOP">$C $F $H $J $L $P
                  $Q $R $Z $a $c $d $e $f $h $i $j $k $l $n $p$r $s
                  $w $x $y $-a</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">of_filter_options</tt></td>

                  <td align="LEFT" valign="TOP">(same as <tt class=
                  "LITERAL">filter_options</tt>)</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">bk_filter_options</tt></td>

                  <td align="LEFT" valign="TOP">$P $w $l $x $y $F
                  $c $L $i $J $C $0n $0h $-a</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">bk_of_filter_options</tt></td>

                  <td align="LEFT" valign="TOP">$w $l $x $y</td>
                </tr>
              </tbody>
            </table>
          </div>
        </li>

        <li>
          <p>By default, for programs that are not being invoked as
          print job file filters, the <tt class=
          "LITERAL">filter_options</tt> arguments are added. For
          print job filters, if the <tt class="LITERAL">:bkf</tt>
          flag is set, then the <tt class=
          "LITERAL">bk_filter_options</tt> and <tt class=
          "LITERAL">bk_of_filter_options</tt> entries are used. The
          default <tt class="LITERAL">bk</tt> filter options are
          the same as originally used with the BSD <b class=
          "APPLICATION">lpr</b> filters. For the <tt class=
          "LITERAL">:of</tt> filter, either the <tt class=
          "LITERAL">of_filter_options</tt> or <tt class=
          "LITERAL">bk_of_filter_options</tt> arguments will be
          added.</p>
        </li>

        <li>
          <p>The program arguments will then be scanned and
          interpreted. Arguments of the form <tt class=
          "LITERAL">$</tt><tt class="LITERAL">letter</tt> will be
          translated into values from the print job control file
          and/or printcap entry. The letters have the following
          meaning:</p>

          <div class="TABLE">
            <a name="FILTEROPTIONFLAGS"></a>

            <p><b>Table 16-2. Filter Command Line Options and
            Values</b></p>

            <table border="1" class="CALSTABLE">
              <thead>
                <tr>
                  <th align="LEFT" valign="TOP">Option</th>

                  <th align="LEFT" valign="TOP">Purpose or
                  Value</th>
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">a</tt> </td>

                  <td align="LEFT" valign="TOP">printcap <tt class=
                  "LITERAL">af</tt> (accounting file name)</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">b</tt> </td>

                  <td align="LEFT" valign="TOP">job size (in K
                  bytes)</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">c</tt> </td>

                  <td align="LEFT" valign="TOP">binary file (<tt
                  class="LITERAL">l</tt> format for print
                  file)</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">d</tt> </td>

                  <td align="LEFT" valign="TOP">printcap <tt class=
                  "LITERAL">cd</tt> or <tt class="LITERAL">sd</tt>
                  entry</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">e</tt> </td>

                  <td align="LEFT" valign="TOP">print job data file
                  name (currently being processed)</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">f</tt> </td>

                  <td align="LEFT" valign="TOP">print job original
                  name when spooled for printing (N info from
                  control file)</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">h</tt> </td>

                  <td align="LEFT" valign="TOP">print job
                  originating host (H info from control file)</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">i</tt> </td>

                  <td align="LEFT" valign="TOP">indent request (I
                  info from control file)</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">j</tt> </td>

                  <td align="LEFT" valign="TOP">job number in spool
                  queue</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">k</tt> </td>

                  <td align="LEFT" valign="TOP">print job control
                  file name</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">l</tt> </td>

                  <td align="LEFT" valign="TOP">printcap <tt class=
                  "LITERAL">pl</tt> (page length)</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">m</tt> </td>

                  <td align="LEFT" valign="TOP">printcap <tt class=
                  "LITERAL">co</tt></td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">n</tt> </td>

                  <td align="LEFT" valign="TOP">user name (L info
                  from control file)</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">p</tt> </td>

                  <td align="LEFT" valign="TOP">remote printer
                  (when processing for bounce queue)</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">r</tt> </td>

                  <td align="LEFT" valign="TOP">remote host (when
                  processing for bounce queue)</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">s</tt> </td>

                  <td align="LEFT" valign="TOP">printcap <tt class=
                  "LITERAL">sf</tt> (status file)</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">t</tt> </td>

                  <td align="LEFT" valign="TOP">time in common UNIX
                  format</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">w</tt> </td>

                  <td align="LEFT" valign="TOP">printcap <tt class=
                  "LITERAL">pw</tt> (page width)</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">x</tt> </td>

                  <td align="LEFT" valign="TOP">printcap <tt class=
                  "LITERAL">px</tt> (page x dimension)</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">y</tt> </td>

                  <td align="LEFT" valign="TOP">printcap <tt class=
                  "LITERAL">py</tt> (page y dimension)</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">F</tt> </td>

                  <td align="LEFT" valign="TOP">print file
                  format</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">P</tt> </td>

                  <td align="LEFT" valign="TOP">printer name</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">S</tt> </td>

                  <td align="LEFT" valign="TOP">printcap <tt class=
                  "LITERAL">cm</tt> (comment field)</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP">Capital letter</td>

                  <td align="LEFT" valign="TOP">Corresponding line
                  from control file</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP">{key}</td>

                  <td align="LEFT" valign="TOP">printcap value for
                  <tt class="LITERAL">key</tt></td>
                </tr>
              </tbody>
            </table>
          </div>
          <br>
          <br>
        </li>

        <li>
          <p>If there is no value for the specified argument, then
          the argument is removed from the list. If there is a
          value, the actual form of the substitution is controlled
          by additional flags as follows.</p>

          <div class="TABLE">
            <a name="AEN8153"></a>

            <p><b>Table 16-3. Filter Command Line Option
            Format</b></p>

            <table border="1" class="CALSTABLE">
              <thead>
                <tr>
                  <th align="LEFT" valign="TOP">Form</th>

                  <th align="LEFT" valign="TOP">
                  TranslatedValue</th>
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">$x</tt> </td>

                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">'-x</tt><tt class=
                  "REPLACEABLE"><i>value</i></tt><tt class=
                  "LITERAL">'</tt></td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">$-x</tt> </td>

                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">'</tt><tt class=
                  "REPLACEABLE"><i>value</i></tt><tt class=
                  "LITERAL">'</tt></td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">$0x</tt> </td>

                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">-x '</tt><tt class=
                  "REPLACEABLE"><i>value</i></tt><tt class=
                  "LITERAL">'</tt></td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">$'x</tt> </td>

                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">-x</tt> <tt class=
                  "REPLACEABLE"><i>value</i></tt></td>
                </tr>
              </tbody>
            </table>
          </div>
          <br>
          <br>

          <p>Each entry in quotes is treated as a single value, as
          in /bin/sh. The <tt class="LITERAL">$'x</tt> does not
          quote the value. Combinations of the various flags are
          allowed. For example, <tt class="LITERAL">$-x</tt> would
          simply substitute the value for <tt class=
          "LITERAL">x</tt>, and then pass the whitespace separated
          components as individual arguments. This last form is
          useful for adding in additional flags on the command
          line.</p>
        </li>

        <li>
          <p>The command line is parsed, metacharacters are
          ruthlessly stripped from all arguments and pathnames and
          replaced by <tt class="LITERAL">_</tt> (underscores), and
          an argument list suitable for the <tt class=
          "LITERAL">execve</tt> system call is formed.</p>
        </li>

        <li>
          <p>A sanitized environment is set up for the program
          execution, with the following environment variables.</p>

          <div class="TABLE">
            <a name="FILTERENV"></a>

            <p><b>Table 16-4. Filter Environment Variables</b></p>

            <table border="1" class="CALSTABLE">
              <thead>
                <tr>
                  <th align="LEFT" valign="TOP">Variable Name</th>

                  <th align="LEFT" valign="TOP">Meaning</th>
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">CONTROL</tt> </td>

                  <td align="LEFT" valign="TOP">control file
                  name</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">DATAFILES</tt> </td>

                  <td align="LEFT" valign="TOP">list of data file
                  names</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">HOME</tt> </td>

                  <td align="LEFT" valign="TOP">Home directory
                  (client only)</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">IFS</tt> </td>

                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">" \t"</tt></td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">LD_LIBRARY_PATH</tt> </td>

                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">:filter_ld_path</tt> configuration
                  information</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">LOGDIR</tt> </td>

                  <td align="LEFT" valign="TOP">Home directory
                  (client only)</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">LOGNAME</tt> </td>

                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">L</tt> control file line</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">PATH</tt> </td>

                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">filter_path</tt> configuration
                  information</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">PRINTCAP_ENTRY</tt> </td>

                  <td align="LEFT" valign="TOP">printcap
                  information</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">SHELL</tt> </td>

                  <td align="LEFT" valign="TOP"><tt class=
                  "OPTION">:sh</tt> configuration information
                  (default <tt class="FILENAME">/bin/sh</tt>)</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">SPOOL_DIR</tt> </td>

                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">:sd</tt> printcap information</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">TZ</tt> </td>

                  <td align="LEFT" valign="TOP">Time zone</td>
                </tr>

                <tr>
                  <td align="LEFT" valign="TOP"><tt class=
                  "LITERAL">USER</tt> </td>

                  <td align="LEFT" valign="TOP">User name (client
                  only)</td>
                </tr>
              </tbody>
            </table>
          </div>
          <br>
          <br>
        </li>

        <li>
          <p>If the filter is to be run by a client program such as
          <b class="APPLICATION">lpr</b>, then the environment
          variables specified by the <tt class=
          "LITERAL">pass_env</tt> configuration or printcap option
          will be extracted from the environment, have any
          metacharacters removed, and then placed in the
          environment variable list. Commonly, the <span class=
          "ACRONYM">PGPPASS</span>, <span class=
          "ACRONYM">PGPPASSFD</span>, and <span class=
          "ACRONYM">PGPPATH</span> are specified.</p>
        </li>

        <li>
          <p>The program is started, with <span class=
          "ACRONYM">STDIN</span>, <span class=
          "ACRONYM">STDOUT</span>, and <span class=
          "ACRONYM">STDERR</span> attached to the appropriate files
          or file descriptors. If none is specified, then they are
          attached to <tt class="FILENAME">/dev/null</tt>.</p>
        </li>
      </ol>
      <br>
      <br>
    </div>

    <div class="NAVFOOTER">
      <hr align="LEFT" width="100%">

      <table summary="Footer navigation table" width="100%" border=
      "0" cellpadding="0" cellspacing="0">
        <tr>
          <td width="33%" align="left" valign="top"><a href=
          "chainingfilters.htm" accesskey="P">Prev</a></td>

          <td width="34%" align="center" valign="top"><a href=
          "index.htm" accesskey="H">Home</a></td>

          <td width="33%" align="right" valign="top"><a href=
          "x8279.htm" accesskey="N">Next</a></td>
        </tr>

        <tr>
          <td width="33%" align="left" valign="top">Chaining
          Filters</td>

          <td width="34%" align="center" valign="top"><a href=
          "filters.htm" accesskey="U">Up</a></td>

          <td width="33%" align="right" valign="top"><b class=
          "APPLICATION">LPRng</b> Supported Filters</td>
        </tr>
      </table>
    </div>
  </body>
</html>

