<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta name="generator" content="HTML Tidy, see www.w3.org">
    <title>Accounting File</title>
    <meta name="GENERATOR" content=
    "Modular DocBook HTML Stylesheet Version 1.71 ">
    <link rel="HOME" title=" LPRng-HOWTO" href="index.htm">
    <link rel="UP" title="Accounting " href="accountingref.htm">
    <link rel="PREVIOUS" title="Accounting Information" href=
    "x9483.htm">
    <link rel="NEXT" title="Authorization and Quotas" href=
    "x9537.htm">
  </head>

  <body class="SECT1" bgcolor="#FFFFFF" text="#000000" link=
  "#0000FF" vlink="#840084" alink="#0000FF">
    <div class="NAVHEADER">
      <table summary="Header navigation table" width="100%" border=
      "0" cellpadding="0" cellspacing="0">
        <tr>
          <th colspan="3" align="center">LPRng-HOWTO: 1 Apr 2002
          (For LPRng-3.8.10)</th>
        </tr>

        <tr>
          <td width="10%" align="left" valign="bottom"><a href=
          "x9483.htm" accesskey="P">Prev</a></td>

          <td width="80%" align="center" valign="bottom">Chapter
          18. Accounting</td>

          <td width="10%" align="right" valign="bottom"><a href=
          "x9537.htm" accesskey="N">Next</a></td>
        </tr>
      </table>
      <hr align="LEFT" width="100%">
    </div>

    <div class="SECT1">
      <h1 class="SECT1"><a name="AEN9497">18.3. Accounting
      File</a></h1>

      <p>The Accounting File (<tt class="LITERAL">:af=</tt>) option
      value specifies the destination of accounting information. If
      the format of the <tt class="LITERAL">:af</tt> option is <tt
      class="LITERAL">:as=| ...</tt> , then the value is assumed to
      be a program to be run to record start and end of job
      information. The program is run in the same manner as a print
      filter. The values of the <tt class="LITERAL">:as</tt> and
      <tt class="LITERAL">:ae</tt> options are written to the
      program's <tt class="LITERAL">STDIN</tt> and the output from
      the program's <tt class="LITERAL">STDOUT</tt> is used as
      described below for authorization.</p>

      <p>If the <tt class="LITERAL">:af=</tt> option has the format
      <tt class="LITERAL">host%port</tt> then a TCP/IP connection
      is opened to the specified port on the indicated host. The
      values of the <tt class="LITERAL">:as</tt> and <tt class=
      "LITERAL">:ae</tt> options are written to the remote host.
      The port that the connection originates from will be in the
      range set by the configuration or printcap <i class=
      "EMPHASIS"><a href=
      "rfc1179ref.htm#LPDPORT">originate_port</a></i> option.</p>

      <p>Finally, if the <tt class="LITERAL">:af=</tt> has neither
      of these formats then it will be treated as a pathname to a
      file. If the file exists or the <tt class=
      "LITERAL">create_files</tt> option is true, then the file
      will be opened and the values of the <tt class=
      "LITERAL">:as</tt> and <tt class="LITERAL">:ae</tt> options
      are written to the file. The accounting file should be
      periodically truncated.&#13;</p>

      <p>&#13;By convention the <tt class="LITERAL">:af=</tt> value
      is passed to filters as a command line option. LPRng will
      pass the option value only if it is specifies a file or
      network destination. This implies that accounting information
      can be written to the accounting file or network destinations
      by the print spooler, <tt class="LITERAL">:of</tt> filters,
      or print file filters. The filters are responsible for
      opening the accounting file or network connection.</p>

      <p>The following is an example of information written to the
      accounting file:</p>

      <div class="INFORMALEXAMPLE">
        <a name="AEN9523"></a>
<pre class="SCREEN">
    jobstart '-Hh4.private' '-nroot' '-Pps' '-kcfA938h4.private' \
    '-b1093' '-tNov  5 19:39:25'
    start '-p12942' '-kcfA938h4.private' '-nroot' '-hh4.private' '-Pps' \
    '-c0' '-Fo' '-tSun Nov  5 19:39:25 1995'
    filestart '-p12944' '-kcfA938h4.private' '-nroot' '-hh4.private' '-Pps' \
    '-c0' '-Ff' '-tSun Nov  5 19:39:27 1995'
    fileend '-p12944' '-kcfA938h4.private' '-nroot' '-hh4.private' '-Pps' \
    '-b3' '-c0' '-Ff' '-tSun Nov  5 19:39:58 1995'
    end '-p12942' '-kcfA938h4.private' '-nroot' '-hh4.private' '-Pps' \
    '-b2' '-c0' '-Fo' '-tSun Nov  5 19:39:59 1995'
    jobend '-Hh4.private' '-nroot' '-Pps' '-kcfA938h4.private' \
    '-b1093' '-tNov  5 19:39:59'
</pre>
      </div>
      <br>
      <br>

      <p>The <tt class="LITERAL">jobstart</tt> and <tt class=
      "LITERAL">jobend</tt> lines are written by <b class=
      "APPLICATION">lpd</b> and are the expanded <tt class=
      "LITERAL">:as</tt> and <tt class="LITERAL">:ae</tt> values.
      The <tt class="LITERAL">start</tt> and <tt class=
      "LITERAL">end</tt> line are added by the <tt class=
      "LITERAL">:of</tt> filter. This filter usually queries the
      printer and gets printer dependent accounting information
      such as the pagecounter value. The <tt class=
      "LITERAL">:of</tt> filter is then suspended and the job is
      processed by the various format dependent filters. The the
      <tt class="LITERAL">filestart</tt> and <tt class=
      "LITERAL">fileend</tt> lines are produced by the other
      filters.</p>
    </div>

    <div class="NAVFOOTER">
      <hr align="LEFT" width="100%">

      <table summary="Footer navigation table" width="100%" border=
      "0" cellpadding="0" cellspacing="0">
        <tr>
          <td width="33%" align="left" valign="top"><a href=
          "x9483.htm" accesskey="P">Prev</a></td>

          <td width="34%" align="center" valign="top"><a href=
          "index.htm" accesskey="H">Home</a></td>

          <td width="33%" align="right" valign="top"><a href=
          "x9537.htm" accesskey="N">Next</a></td>
        </tr>

        <tr>
          <td width="33%" align="left" valign="top">Accounting
          Information</td>

          <td width="34%" align="center" valign="top"><a href=
          "accountingref.htm" accesskey="U">Up</a></td>

          <td width="33%" align="right" valign="top">Authorization
          and Quotas</td>
        </tr>
      </table>
    </div>
  </body>
</html>

