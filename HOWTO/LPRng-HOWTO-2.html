<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="SGML-Tools 1.0.9">
 <TITLE> LPRng-HOWTO: Print Spooling Overview</TITLE>
 <LINK HREF="LPRng-HOWTO-3.html" REL=next>
 <LINK HREF="LPRng-HOWTO-1.html" REL=previous>
 <LINK HREF="LPRng-HOWTO.html#toc2" REL=contents>
</HEAD>
<BODY>
<A HREF="LPRng-HOWTO-3.html">Next</A>
<A HREF="LPRng-HOWTO-1.html">Previous</A>
<A HREF="LPRng-HOWTO.html#toc2">Contents</A>
<HR>
<H2><A NAME="overview"></A> <A NAME="s2">2. Print Spooling Overview</A></H2>

<P>A print spooler is a program that accepts
<I>print jobs</I>
(which are usually one or more files)
from a program or network interface,
stores them in a
<I>spool queue</I>,
and then sends them to a printer or another
print spooler.
Usually there are facilities to submit jobs,
check on the current job status,
remove jobs from spool queues,
and perform administrative functions such as starting or
stopping printing.
<P>A print spooler is a client/server application.
The client programs are used to submit jobs to the print spooler
program which performs the actual printing operations.
In order to carry out these operations,
the server may need to use other programs to convert print job files
into a format acceptable to a printer,
or perform various accounting or administrative functions.
<H2><A NAME="ss2.1">2.1 Overview</A>
</H2>

<P>
<BLOCKQUOTE><CODE>
<PRE>
+---------+    +-----+    +-----+     +--------+    +---------+
| program | -> | lpr | -> | lpd |  -> | filter | -> | printer |
+---------+    +-----+  * +-----+     +--------+    +---------+
                  *    *     |   
               printcap      V
                          +-----+     +--------+    +---------+
                          | lpd |  -> | filter | -> | printer |
                          +-----+     +--------+    +---------+

                           Figure 1
</PRE>
</CODE></BLOCKQUOTE>
<P>Figure 1 shows the flow of data between the individual components of the
LPRng print spooling system.
A program (or user) will use the <CODE>lpr</CODE> program to send a file
to the <CODE>lpd</CODE> server over a TCP/IP connection.
The <CODE>lpd</CODE>server will store the file temporarily in a
spool queue directory.
The information needed by the <CODE>lpr</CODE> and <CODE>lpd</CODE> programs to carry
out this activity is stored in the
<CODE>printcap</CODE>  (usually called the <CODE>/etc/printcap</CODE>) database file.
<P>The <CODE>lpd</CODE> server sorts the queue entries and determines the print order.
It will select a job to be printed,
open a connection to the printer,
and then use a <I>filter</I> program to convert the file contents into a
format suitable for the printer.
If the file does not need conversion,
then the <CODE>lpd</CODE> server will send the file directly to the printer.
<P>The <CODE>lpd</CODE> server can also <CODE>forward</CODE> jobs to another print server
over a network connection,
optionally sending them through a filter as well.
The destination server can in turn forward the job or send it to a printer.
<P>The protocol or commands used to do this job forward and transfer are
specified by
<A HREF="LPRng-HOWTO-18.html#rfc1179ref">RFC1179</A>.
This protocol specifies how the <CODE>lpr</CODE> client program sends a job
to the <CODE>lpd</CODE> server,
as well as how the <CODE>lpd</CODE> server forwards jobs to another server.
In addition to job submission,
RFC1179 specifies commands to obtain queue status,
to remove jobs from the queue,
and to start and stop print queues.
<H2><A NAME="ss2.2">2.2 Sample Printcap Entry</A>
</H2>

<P>As described in the
<A HREF="#overview">Print Spooling Overview</A>,
the information in the <CODE>printcap</CODE> database is used control printing
operations.
While there is no RFC specifying its format or content,
there is a strong <I>de facto</I> standard for its format.
For a complete description of the <CODE>printcap</CODE> database see
<A HREF="LPRng-HOWTO-8.html#printcapref">Using the Printcap Database</A>.
For a list of all of the <CODE>printcap</CODE> and configuration options see
<A HREF="LPRng-HOWTO-21.html#index">Index To All The Configuration and Printcap Options</A>.
<P>Here is a sample printcap:
<BLOCKQUOTE><CODE>
<PRE>
lp:lp=psqueue@printserver.astart.com
</PRE>
</CODE></BLOCKQUOTE>
<P>This printcap information tells the <I>client</I> programs
that when a client wants to print a job on the
<CODE>lp</CODE> printer,
that these jobs should be sent to the
<CODE>psqueue</CODE> on host <CODE>printerserver.astart.com</CODE>.
On the printserver,
the following printcap entry is used by the <CODE>lpd</CODE>
server to do the printing.
<BLOCKQUOTE><CODE>
<PRE>
psqueue:server
  :lp=/dev/lp0
  :sd=/var/spool/lpd/psqueue
  :if=/usr/local/bin/ifhp
</PRE>
</CODE></BLOCKQUOTE>
<P>The <CODE>sd</CODE> (spool queue directory) entry specifies the directory where
print jobs will be placed.
The <CODE>lp</CODE> line specifies an actual output device,
so the <CODE>lpd</CODE> server will open this device for printing.
The <CODE>if</CODE> (input file filter) entry specifies the program to be used
to translate the input file into a format compatible with the actual
printer.
Many of the times there is not need for conversion,
and this entry is left out.
<H2><A NAME="ss2.3">2.3 Print Server Configuration</A>
</H2>

<P>The previous sections have given a very high level view of printing
operations.
In order to do printing the following programs and information must
be established:
<OL>
<LI>The printer itself,
and the interface to the printer.</LI>
<LI>Client programs for use by users or other programs to send jobs
to the print server and perform administrative functions.</LI>
<LI>A server program that runs on a host that accepts jobs for printing.</LI>
<LI>Printcap information to control the printing operations.</LI>
<LI>Filters that convert print jobs into formats compatible with printers.</LI>
<LI>System facilities such as spool queues or storage areas for jobs.</LI>
</OL>
<P>The following sections will cover each of these topics in turn.
The initial sections assume that most users are setting up printers
on small systems and require an extremely simple print capability.
Later sections explore the various configurations that can be used
to support large networks of print spoolers as would be found in
large academic institutions or businesses.
<HR>
<A HREF="LPRng-HOWTO-3.html">Next</A>
<A HREF="LPRng-HOWTO-1.html">Previous</A>
<A HREF="LPRng-HOWTO.html#toc2">Contents</A>
</BODY>
</HTML>
